!function(e){function n(){function n(e){c=!0,d=e.touches[0].pageY}function t(){c=!1}function o(e){c&&(u=e.touches[0].pageY,window.scrollBy(0,d-u))}var i={zoom:a.zoom,styles:a.styles,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1,draggable:!0,mapTypeControl:!1,panControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.LEFT_BOTTOM}};i.center=new google.maps.LatLng(a.center.latitude,a.center.longitude),l=new google.maps.Map(e(s)[0],i);var c=!1,d=0,u=0,f=s[0];f.addEventListener?(f.addEventListener("touchstart",n,!0),f.addEventListener("touchend",t,!0),f.addEventListener("touchmove",o,!0)):f.attachEvent&&(f.attachEvent("touchstart",n),f.attachEvent("touchend",t),f.attachEvent("touchmove",o)),google.maps.event.addListener(l,"zoom_changed",function(){e.each(g,function(e,n){void 0!==n.infobox&&(n.infobox.close(),n.infobox.isOpen=!1)})}),r()}function t(n,t){if(void 0===t)return!1;if(0==n.length)return!1;var o=!1;return e.each(n,function(e,n){n.getCenter()==t.getCenter()&&(o=n)}),o}function o(n){e.each(n.getMarkers(),function(){0==this.marker.isHidden&&(this.marker.isHidden=!0,this.marker.close())});var t=new InfoBox({markers:n.getMarkers(),draggable:!0,content:'<div class="clusterer"><div class="clusterer-inner">'+n.getMarkers().length+"</div></div>",disableAutoPan:!0,pixelOffset:new google.maps.Size(-21,-21),position:n.getCenter(),closeBoxURL:"",isHidden:!1,enableEventPropagation:!0,pane:"floatPane"});n.cluster=t,n.markers=n.getMarkers(),n.cluster.open(l,n.marker),u.push(n)}function r(){e.each(a.markers,function(n,t){var o={position:new google.maps.LatLng(t.latitude,t.longitude),map:l};a.marker.width&&a.marker.height&&a.transparentMarkerImage&&(o.icon={size:new google.maps.Size(a.marker.width,a.marker.height),url:a.transparentMarkerImage});var r=new google.maps.Marker(o);t.content&&(r.infobox=new InfoBox({content:t.content,disableAutoPan:!0,pixelOffset:new google.maps.Size(a.infowindow.offsetX,a.infowindow.offsetY,a.infowindow.offsetX,a.infowindow.offsetY),position:new google.maps.LatLng(t.latitude,t.longitude),isHidden:!1,closeBoxURL:"",pane:"floatPane",enableEventPropagation:!1}),r.infobox.isOpen=!1),r.marker=new InfoBox({draggable:!0,content:t.marker_content,disableAutoPan:!0,pixelOffset:new google.maps.Size(-a.marker.width/2,-a.marker.height),position:new google.maps.LatLng(t.latitude,t.longitude),closeBoxURL:"",isHidden:!1,pane:"floatPane",enableEventPropagation:!0}),r.marker.isHidden=!1,r.marker.open(l,r),g.push(r),google.maps.event.addListener(r,"click",function(n){if(void 0!==r.infobox){var t=this;e.each(g,function(e,n){n!==t&&(n.infobox.close(),n.infobox.isOpen=!1)}),t.infobox&&(t.infobox.isOpen===!1?(t.infobox.open(l,this),t.infobox.isOpen=!0):(t.infobox.close(),t.infobox.isOpen=!1))}})}),c=new MarkerClusterer(l,g,{gridSize:a.cluster.gridSize,styles:[{height:a.cluster.height,url:a.transparentClusterImage,width:a.cluster.width}]}),u=new Array,d=google.maps.event.addListener(c,"clusteringend",function(n){var r=n.getClusters(),i=new Array;e.each(r,function(e,n){n.getMarkers().length>1&&i.push(n)}),e.each(r,function(n,r){if(r.getMarkers().length>1){var i=t(u,r);i!==!1?(i.cluster.setContent('<div class="clusterer"><div class="clusterer-inner">'+r.getMarkers().length+"</div></div>"),i.markers=r.getMarkers(),e.each(r.getMarkers(),function(e,n){0==n.marker.isHidden&&(n.marker.isHidden=!0,n.marker.close())})):o(r)}else e.each(r.getMarkers(),function(e,n){1==n.marker.isHidden&&(n.marker.open(l,this),n.marker.isHidden=!1)}),e.each(u,function(e,n){void 0!==r&&void 0!==n&&n.getCenter()==r.getCenter()&&(n.cluster.close(),u.splice(e,1))})});var a=new Array;e.each(u,function(n,t){var o=!0;e.each(r,function(e,n){n.getCenter()==t.getCenter()&&(o=!1)}),o?t.cluster.close():a.push(t)}),u=a}),e(document).on("click",".infobox .close",function(n){n.preventDefault(),e.each(g,function(e,n){n.infobox.isHidden=!0,n.infobox.close()})})}var a,s,l,c,d,g=new Array,u=new Array,f={init:function(t){s=e(this);var o=e.extend({center:{latitude:40.761077,longitude:-73.983307},styles:null,zoom:14,markers:[],infowindow:{borderBottomSpacing:6,height:150,width:340,offsetX:-21,offsetY:-21},marker:{height:40,width:40},cluster:{height:40,width:40,gridSize:40}});return a=e.extend({},o,t),n(),t.callback&&t.callback(),e(this)},removeMarkers:function(){for(i=0;i<g.length;i++)g[i].infobox.close(),g[i].marker.close(),g[i].setMap(null);c.clearMarkers(),e.each(u,function(e,n){n.cluster.close()}),d.remove()},addMarkers:function(e){g=new Array,a.locations=e.locations,a.contents=e.contents,a.types=e.types,r()}};e.fn.google_map=function(n){return f[n]?f[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on Aviators Map"):f.init.apply(this,arguments)}}(jQuery);